#include "modules.h"

typedef struct {
    uint32 shape[4][4];
    uint32 size;
    uint32 color;
} mino;

static mino O = {
    {{1, 1, 0, 0},
    {1, 1, 0, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0}},
    2,
    YELLOW};
static mino I = {
    {{0, 0, 0, 0},
    {1, 1, 1, 1},
    {0, 0, 0, 0},
    {0, 0, 0, 0}},
    4,
    LIGHTBLUE};
static mino T = {
    {{0, 1, 0, 0},
    {1, 1, 1, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0}},
    3,
    DARK PINK};
static mino L = {
    {{0, 0, 1, 0},
    {1, 1, 1, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0}},
    3,
    PINK};
static mino J = {
    {{1, 0, 0, 0},
    {1, 1, 1, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0}},
    3,
    BLUE};
static mino S = {
    {{0, 1, 1, 0},
    {1, 1, 0, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0}},
    3,
    GREEN};
static mino Z = {
    {{1, 1, 0, 0},
    {0, 1, 1, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0}},
    3,
    RED};
static uint32 spin_array[4][4] = {
    {0,0,0,0},
    {0,0,0,0},
    {0,0,0,0},
    {0,0,0,0}};

static uint32 FIELD[22][12] = {
    {1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}};

void rspin(mino *m) {
    // 右回転時は(x,y)->((size+1)-y,x)になる
    int i = 0, j = 0;
    for(i = 0; i < m->size; i++) {
        for(j = 0; j < m->size; j++) {
            spin_array[i][j] = 0;
        }
    }
    for(i = 0; i < m->size; i++) {
        for(j = 0; j < m->size; j++) {
            spin_array[i][j] = m->shape[m->size-j-1][i];
        }
    }
    for(i = 0; i < m->size; i++) {
        for(j = 0; j < m->size; j++) {
            m->shape[i][j] = spin_array[i][j];
        }
    }
}
void lspin(mino *m) {
    // 左回転時は(x,y)->(y,(size+1)-x)になる
    for(i = 0; i < m->size; i++) {
        for(j = 0; j < m->size; j++) {
            spin_array[i][j] = 0;
        }
    }
    int i = 0, j = 0;
    for(i = 0; i < m->size; i++) {
        for(j = 0; j < m->size; j++) {
            spin_array[i][j] = m->shape[j][m->size-i-1];
        }
    }
    for(i = 0; i < m->size; i++) {
        for(j = 0; j < m->size; j++) {
            m->shape[i][j] = spin_array[i][j];
        }
    }
}


uint32 main(void) {
    draw_block(0, 0, 100, 100, BLACK << 8 | GREEN);
}
